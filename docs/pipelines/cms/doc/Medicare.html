<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medicare Files Handling &mdash; NSAPH CMS Data Processing Package 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> NSAPH CMS Data Processing Package
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">CMS Manipulation Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="Medicaid.html">Handling Medicaid data</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline/medicaid.html">Full Medicaid Processing Pipeline</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Also:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="LegacyMedicaid.html">Importing Medicaid Data Processed by the Legacy Pipeline</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NSAPH CMS Data Processing Package</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Medicare Files Handling</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/doc/Medicare.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="medicare-files-handling">
<h1>Medicare Files Handling<a class="headerlink" href="#medicare-files-handling" title="Permalink to this headline"></a></h1>
<section id="ingesting-raw-files">
<h2>Ingesting Raw Files<a class="headerlink" href="#ingesting-raw-files" title="Permalink to this headline"></a></h2>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h3>
<p>There are two types of tables:</p>
<ul class="simple">
<li><p>Patient summary, aka enrollment, aka denominator</p></li>
<li><p>Inpatient admissions</p></li>
</ul>
<p>Unfortunately, the structure of medicare files is different for
almost every year.</p>
<p>Summary files for some years come in pairs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mbsf_ab_summary</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mbsf_d_cmpnts</span></code></p></li>
</ul>
<p>For other years we have a single file:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mbsf_abcd_summary</span></code></p></li>
</ul>
<p>Inpatient admissions files always follow <code class="docutils literal notranslate"><span class="pre">medpar_all_file</span></code> pattern.</p>
<p>Columns vary from year to year even for similarly named files,
new columns are being added and column names are sometimes changed.</p>
<p>To add insult to injury, for years prior to 2011 (1999-2010) we do not
have original files, but preprocessed files with patient summary
(called denominators) and admissions. They are in SAS 7BDAT format,
however columns are also different for different years.</p>
</section>
<section id="storing-in-the-database">
<h3>Storing in the Database<a class="headerlink" href="#storing-in-the-database" title="Permalink to this headline"></a></h3>
<p>Given the difference in file structures we create a separate table
for every file. However, to make it easier to join these tables we:</p>
<ul class="simple">
<li><p>Add a column containing original file name to every table</p></li>
<li><p>Add generated columns with uniform names for:</p>
<ul>
<li><p>Year</p></li>
<li><p>State</p></li>
<li><p>Bene_Id</p></li>
<li><p>Zip code</p></li>
</ul>
</li>
</ul>
<p>Originally, these data is stored in columns with the following possible names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;bene_id&quot;</span><span class="p">:</span>  <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;bene_id&quot;</span><span class="p">,</span> <span class="s2">&quot;intbid&quot;</span><span class="p">,</span> <span class="s2">&quot;qid&quot;</span><span class="p">,</span> <span class="s2">&quot;bid_5333*&quot;</span><span class="p">]),</span>
<span class="s2">&quot;state&quot;</span><span class="p">:</span>  <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="s2">&quot;ssa_state&quot;</span><span class="p">,</span> <span class="s2">&quot;state_code&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;bene_rsdnc_ssa_state_cd&quot;</span><span class="p">,</span> <span class="s2">&quot;state_cd&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;medpar_bene_rsdnc_ssa_state_cd&quot;</span><span class="p">]),</span>
<span class="s2">&quot;zip&quot;</span><span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;zip&quot;</span><span class="p">,</span> <span class="s2">&quot;zipcode&quot;</span><span class="p">,</span> <span class="s2">&quot;bene_zip_cd&quot;</span><span class="p">,</span> <span class="s2">&quot;bene_zip&quot;</span><span class="p">,</span>
               <span class="s2">&quot;bene_mlg_cntct_zip_cd&quot;</span><span class="p">,</span>
               <span class="s2">&quot;medpar_bene_mlg_cntct_zip_cd&quot;</span><span class="p">]),</span>
<span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;enrolyr&quot;</span><span class="p">,</span> <span class="s2">&quot;bene_enrollmt_ref_yr&quot;</span><span class="p">,</span>
                <span class="s2">&quot;rfrnc_yr&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>When a table has no natural primary key (admission tables) we add a record
number column. This column ha sno meaning but allows to trace a record to the
original data.</p>
</section>
<section id="files-for-1999-to-2010">
<h3>Files for 1999 to 2010<a class="headerlink" href="#files-for-1999-to-2010" title="Permalink to this headline"></a></h3>
<p>These files are in SAS7BDAT format. They have been stored on RCE
in two directories:</p>
<ul class="simple">
<li><p>denominator</p></li>
<li><p>inpatient</p></li>
</ul>
<p>One file per year. SAS7BDAT format contains metadata with column
names and types. We use this metadata to generate appropriate database schema.</p>
<p>See the code for handling these files:</p>
<ul class="simple">
<li><p><a class="reference external" href="members/mcr_sas2yaml.html">Metadata and data model</a></p></li>
<li><p><a class="reference external" href="members/mcr_sas2db.html">Ingesting data</a></p></li>
</ul>
</section>
<section id="files-for-years-2011-and-later">
<h3>Files for Years 2011 and later<a class="headerlink" href="#files-for-years-2011-and-later" title="Permalink to this headline"></a></h3>
<p>These files are original files from Resdac. They come in Fixed Width Format
(FWF). For each file the structure is described in File Transfer
Summary (FTS) file. Unfortunately these files are intended for reading by
a human and is difficult to parse automatically. A
<a class="reference external" href="members/fts2yaml.html">partial parser</a> that
relies on a known file type is implemented in Python. The information
extarcted by the parser is used to:</p>
<ul class="simple">
<li><p>Generate data model (database schema)</p></li>
<li><p>Generate metadata for the FWF Reader</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Harvard University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>