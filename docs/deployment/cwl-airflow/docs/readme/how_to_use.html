<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to use &mdash; NSAPH Data Platform 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sphinx_paramlinks.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> NSAPH Data Platform
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../README.html">NSAPH Data Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Guide.html">CWL-Airflow Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Howto.html">Howto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Configuration.html">Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Testing.html">Testing the installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Glossary.html">Glossary and FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/UsefulCommands.html">Some useful commands:</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">NSAPH Data Platform</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>How to use</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/cwl-airflow/docs/readme/how_to_use.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="how-to-use">
<h1>How to use<a class="headerlink" href="#how-to-use" title="Permalink to this headline"></a></h1>
<section id="initial-configuration">
<h2>Initial configuration<a class="headerlink" href="#initial-configuration" title="Permalink to this headline"></a></h2>
<p>Before using <strong>CWL-airflow</strong> it should be configured with <code class="docutils literal notranslate"><span class="pre">cwl-airflow</span> <span class="pre">init</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cwl-airflow init --help

usage: cwl-airflow init [-h] [--home HOME] [--config CONFIG] [--upgrade]

optional arguments:
  -h, --help       show this help message and exit
  --home HOME      Set path to Airflow home directory. Default: first try
                   AIRFLOW_HOME then &#39;~/airflow&#39;
  --config CONFIG  Set path to Airflow configuration file. Default: first try
                   AIRFLOW_CONFIG then &#39;[airflow home]/airflow.cfg&#39;
  --upgrade        Upgrade old CWLDAG files to the latest format. Default:
                   False
</pre></div>
</div>
<p><strong>Init command will run the following steps</strong> for the specified <code class="docutils literal notranslate"><span class="pre">--home</span></code> and <code class="docutils literal notranslate"><span class="pre">--config</span></code> parameters:</p>
<ul class="simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">airflow</span> <span class="pre">--help</span></code> to create a default <code class="docutils literal notranslate"><span class="pre">airflow.cfg</span></code></p></li>
<li><p>Update <code class="docutils literal notranslate"><span class="pre">airflow.cfg</span></code> to hide paused DAGs, skip loading example DAGs and connections and <strong>do not</strong> pause newly created DAGs. Also, we set our custom <code class="docutils literal notranslate"><span class="pre">logging_config_class</span></code> to split Airflow and CWL related logs into the separate files. In case of upgrading from the previous version of CWL-Airflow that used Airflow &lt; 2.0.0 to the latest one, <code class="docutils literal notranslate"><span class="pre">airflow.cfg</span></code> will be backuped and upgraded to fit Airflow 2.1.4. You will have to manually make sure that all custom fields were properly copied to the new <code class="docutils literal notranslate"><span class="pre">airflow.cfg</span></code></p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">airflow</span> <span class="pre">db</span> <span class="pre">init</span></code> to init/upgrade Airflow metadata database.</p></li>
<li><p>If run with <code class="docutils literal notranslate"><span class="pre">--upgrade</span></code>, upgrade old CWLDAGs to correspond to the latest format, save original CWLDAGs into <code class="docutils literal notranslate"><span class="pre">deprecated_dags</span></code> folder.</p></li>
<li><p>Put <strong>clean_dag_run.py</strong> into the DAGs folder.</p></li>
</ul>
</section>
<section id="updating-airflow-cfg">
<h2>Updating airflow.cfg<a class="headerlink" href="#updating-airflow-cfg" title="Permalink to this headline"></a></h2>
<p>For precise configuration the <code class="docutils literal notranslate"><span class="pre">[cwl]</span></code> section can be added to <strong>airflow.cfg</strong>. All of the parameters descibed below are <strong>optional</strong> and will take their default values if not provided.</p>
<p>If job already included absolute paths for <strong>tmp_folder</strong> and <strong>outputs_folder</strong> the corresponent parameters from <strong>airflow.cfg</strong> will be ignored.</p>
<p>In other situation, for example when running CWL-Airflow with <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code>, one may need to set the exact locations for <strong>tmp</strong>, <strong>outputs</strong>, <strong>inputs</strong> and <strong>pickle</strong> folders to allow their proper mounting to Docker container.</p>
<p>Also, following the abovementioned scenario, all input files required for workflow execution might be placed into <strong>inputs_folder</strong>. At the same time, when using relative locations in the job file, all paths will be resolved based on the same <strong>inputs_folder</strong>. For additional details refer to <a class="reference external" href="#running-cwl-airflow-with-docker-compose">Running CWL-Airflow with docker-compose</a> section.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[cwl]</span>

<span class="c1"># Temp folder to keep intermediate workflow execution data.</span>
<span class="c1"># Ignored if job already has tmp_folder set as absolute path.</span>
<span class="c1"># If job has tmp_folder set as a relative path, it will be resolved based on this location.</span>
<span class="c1"># Default: AIRFLOW_HOME/cwl_tmp_folder</span>
<span class="na">tmp_folder</span> <span class="o">=</span>

<span class="c1"># Output folder to save workflow execution results.</span>
<span class="c1"># Ignored if job already has outputs_folder set as absolute path.</span>
<span class="c1"># If job has outputs_folder set as a relative path, it will be resolved based on this location.</span>
<span class="c1"># Default: AIRFLOW_HOME/cwl_outputs_folder</span>
<span class="na">outputs_folder</span> <span class="o">=</span> 

<span class="c1"># Folder to keep input files.</span>
<span class="c1"># If job has relative paths for input files they will be resolved based on this location.</span>
<span class="c1"># Default: AIRFLOW_HOME/cwl_inputs_folder</span>
<span class="na">inputs_folder</span> <span class="o">=</span>

<span class="c1"># Folder to keep pickled workflows for fast workflow loading.</span>
<span class="c1"># Default: AIRFLOW_HOME/cwl_pickle_folder</span>
<span class="na">pickle_folder</span> <span class="o">=</span> 

<span class="c1"># Boolean parameter to force using docker for workflow step execution.</span>
<span class="c1"># Default: True</span>
<span class="na">use_container</span> <span class="o">=</span> 

<span class="c1"># Boolean parameter to disable passing the current user id to &quot;docker run --user&quot;.</span>
<span class="c1"># Default: False</span>
<span class="na">no_match_user</span> <span class="o">=</span> 
</pre></div>
</div>
</section>
<section id="adding-a-pipeline">
<h2>Adding a pipeline<a class="headerlink" href="#adding-a-pipeline" title="Permalink to this headline"></a></h2>
<section id="set-absolute-path-to-the-workflow-file">
<h3><strong>Set absolute path to the workflow file</strong><a class="headerlink" href="#set-absolute-path-to-the-workflow-file" title="Permalink to this headline"></a></h3>
<p>The easiest way to add a new pipeline to CWL-airflow is to put the following python script into your DAGs folder. Here, <code class="docutils literal notranslate"><span class="pre">workflow</span></code> parameter is initialized with the absolute path to the CWL workflow file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">from</span> <span class="nn">cwl_airflow.extensions.cwldag</span> <span class="kn">import</span> <span class="n">CWLDAG</span>
<span class="n">dag</span> <span class="o">=</span> <span class="n">CWLDAG</span><span class="p">(</span>
    <span class="n">workflow</span><span class="o">=</span><span class="s2">&quot;/absolute/path/to/workflow.cwl&quot;</span><span class="p">,</span>
    <span class="n">dag_id</span><span class="o">=</span><span class="s2">&quot;my_dag_name&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>As <code class="docutils literal notranslate"><span class="pre">CWLDAG</span></code> class was inherited from Airflow’s <code class="docutils literal notranslate"><span class="pre">DAG</span></code>, additional arguments, such as <code class="docutils literal notranslate"><span class="pre">default_args</span></code>, can be provided when calling class constructor.</p>
<p><code class="docutils literal notranslate"><span class="pre">default_args</span></code> can also include <code class="docutils literal notranslate"><span class="pre">cwl</span></code> section similar to the one from <strong>airflow.cfg</strong> file described in <a class="reference external" href="#updating-airflow.cfg">Updating airflow.cfg</a> section. However, parameters from <strong>airflow.cfg</strong> will always <strong>have higher priority</strong> compared to those that were passed in constructor.</p>
</section>
<section id="use-zlib-compressed-workflow-file-content">
<h3><strong>Use zlib compressed workflow file content</strong><a class="headerlink" href="#use-zlib-compressed-workflow-file-content" title="Permalink to this headline"></a></h3>
<p>Alternatively to file location, the value of <code class="docutils literal notranslate"><span class="pre">workflow</span></code> parameter can be initialized with <strong>base64 encoded zlib compressed</strong> file content. Below is an <strong>example of script</strong> generating compressed workflow content.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cwl_airflow.utilities.helpers</span> <span class="kn">import</span> <span class="n">get_compressed</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;workflow.cwl&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_stream</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">get_compressed</span><span class="p">(</span><span class="n">input_stream</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Note</strong>, to add a new pipeline one can also use <strong>POST</strong> to <code class="docutils literal notranslate"><span class="pre">/dags</span></code> API endpoing. For additional details refer to <a class="reference external" href="#using-an-api">Using an API</a> section.</p>
<p>A new pipeline can be run after Airflow Scheduler loads new DAG (by default if happens <strong>every 5 minutes</strong>).</p>
</section>
</section>
<section id="executing-a-pipeline">
<h2>Executing a pipeline<a class="headerlink" href="#executing-a-pipeline" title="Permalink to this headline"></a></h2>
<section id="using-airflow-ui">
<h3><strong>Using Airflow UI</strong><a class="headerlink" href="#using-airflow-ui" title="Permalink to this headline"></a></h3>
<p>The most convenient way to <strong>manually execute</strong> DAG is to trigger it from <strong>Airflow UI</strong>. Input parameters can be set in the <strong>job</strong> section of the DAG run configuration as in the example below.</p>
<p><img alt="../../../_images/trigger_1.jpg" src="../../../_images/trigger_1.jpg" />
<img alt="../../../_images/trigger_2.jpg" src="../../../_images/trigger_2.jpg" /></p>
</section>
<section id="using-airflow-cli">
<h3><strong>Using Airflow CLI</strong><a class="headerlink" href="#using-airflow-cli" title="Permalink to this headline"></a></h3>
<p>Alternatively, DAGs can be triggered through the <strong>Airflow CLI</strong> with the JSON input paramerers file.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ airflow trigger_dag --conf <span class="s2">&quot;{\&quot;job\&quot;:</span><span class="k">$(</span>cat ./bam-bedgraph-bigwig.json<span class="k">)</span><span class="s2">}&quot;</span> bam-bedgraph-bigwig
</pre></div>
</div>
<p><strong>Note</strong>, to trigger workflow execution one can also use <strong>POST</strong> to <code class="docutils literal notranslate"><span class="pre">/dag_runs</span></code> API endpoing. For additional details refer to <a class="reference external" href="#using-an-api">Using an API</a> section.</p>
</section>
</section>
<section id="posting-pipeline-execution-progress-statistics-and-results">
<h2>Posting pipeline execution progress, statistics and results<a class="headerlink" href="#posting-pipeline-execution-progress-statistics-and-results" title="Permalink to this headline"></a></h2>
<p>To make CWL-Airflow <strong>post workflow executions progress, statistics and results</strong> <code class="docutils literal notranslate"><span class="pre">process_report</span></code> connection should be added. Parameters can be adjusted based on the current needs following the example below.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ airflow connections add process_report --conn-type http --conn-host localhost --conn-port <span class="m">3070</span>
</pre></div>
</div>
<p>In case CWL-Airflow failed to POST progress updates or workflow execution results, the corresponded records with the prefixes <code class="docutils literal notranslate"><span class="pre">post_progress__</span></code> and <code class="docutils literal notranslate"><span class="pre">post_results__</span></code> will be added to the Airflow Variables. Later, when CWL-Airlfow API run with <code class="docutils literal notranslate"><span class="pre">--replay</span> <span class="pre">N</span></code> argument, it will attemt to resend not delivered messages every N seconds.
Workflow execution statistics is sent as part of the progress report at the end of the pipeline execution regardless of whether it finished with success or failure. If progress report is sent from the task, the statistics will be set to “”.</p>
<p>On the example below, the workflow execution statistics includes <code class="docutils literal notranslate"><span class="pre">total</span></code> section with the <code class="docutils literal notranslate"><span class="pre">start_date</span></code> in isoformat. This timestamp will be used as a reference point for all other <code class="docutils literal notranslate"><span class="pre">start_date</span></code> and <code class="docutils literal notranslate"><span class="pre">end_date</span></code> fields which are represented in <code class="docutils literal notranslate"><span class="pre">seconds.milliseconds</span></code> format. All <code class="docutils literal notranslate"><span class="pre">tmp_folder_size</span></code> and <code class="docutils literal notranslate"><span class="pre">outputs_folder_size</span></code> are in kBytes.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span>{
  &#39;state&#39;: &#39;success&#39;,
  &#39;dag_id&#39;: &#39;star-index&#39;,
  &#39;run_id&#39;: &#39;ba46dd51-9c7d-4f92-adc5-503a812ddb6d&#39;,
  &#39;progress&#39;: 100,
  &#39;statistics&#39;:
  {
    &#39;version&#39;: &#39;1.0&#39;,
    &#39;total&#39;:
    {
      &#39;tmp_folder_size&#39;: 3080904,
      &#39;outputs_folder_size&#39;: 1538044,
      &#39;start_date&#39;: &#39;2021-01-28T20:55:03.258202+00:00&#39;,
      &#39;end_date&#39;: 60.715
    },
    &#39;steps&#39;:
    {
      &#39;CWLJobDispatcher&#39;:
      {
        &#39;tmp_folder_size&#39;: 4,
        &#39;start_date&#39;: 2.69,
        &#39;end_date&#39;: 6.96
      },
      &#39;CWLJobGatherer&#39;:
      {
        &#39;tmp_folder_size&#39;: 0,
        &#39;start_date&#39;: 56.534,
        &#39;end_date&#39;: 58.718
      },
      &#39;star_generate_indices&#39;:
      {
        &#39;tmp_folder_size&#39;: 3080900,
        &#39;start_date&#39;: 10.657,
        &#39;end_date&#39;: 52.23
      }
    }
  },
  &#39;error&#39;: &#39;&#39;,
  &#39;logs&#39;: &#39;&#39;
}
</pre></div>
</div>
</section>
<section id="using-an-api">
<h2>Using an API<a class="headerlink" href="#using-an-api" title="Permalink to this headline"></a></h2>
<p>Besides built-in experimental API from the Airflow Webserver, CWL-airflow provides <strong>extended API</strong> that supports <a class="reference external" href="https://github.com/ga4gh/workflow-execution-service-schemas">WES</a> and can be run with <code class="docutils literal notranslate"><span class="pre">cwl-airflow</span> <span class="pre">api</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cwl-airflow api --help

usage: cwl-airflow api [-h] [--port PORT] [--host HOST]

optional arguments:
  -h, --help   show this help message and exit
  --port PORT  Set port to run API server. Default: 8081
  --host HOST  Set host to run API server. Default: 127.0.0.1
  --simulation SIMULATION
               Set path to the test suite file to simulate reports.
               Pipelines won&#39;t get triggered in this mode.
  --replay     REPLAY
               Retries to post undelivered progress and results reports to
               the process_report connection every N seconds. If connection
               is not set this parameter is ignored.
               Default: do not resend not delivered reports.
</pre></div>
</div>
<p>Although, <strong>detailed API specification</strong> available on <a class="reference external" href="https://app.swaggerhub.com/apis/michael-kotliar/cwl_airflow_workflow_execution_service/1.0.1">SwaggerHub</a>, here we provide the <strong>most commonly used endpoints</strong>.</p>
<section id="get-list-of-dags">
<h3><strong>1. Get list of dags</strong><a class="headerlink" href="#get-list-of-dags" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/dags</span></code></p>
<p>Parameters:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Name</th>
<th>In</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dag_ids</td>
<td>query</td>
<td>array[string]</td>
<td>false</td>
<td>Dag identifiers</td>
</tr>
</tbody>
</table><p>Response example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;dags&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;dag_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
      <span class="nt">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;string&quot;</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="create-new-dag">
<h3><strong>2. Create new dag</strong><a class="headerlink" href="#create-new-dag" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/dags</span></code></p>
<p>Parameters:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Name</th>
<th>In</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dag_id</td>
<td>query</td>
<td>string</td>
<td>false</td>
<td>Dag identifier</td>
</tr>
<tr>
<td>body</td>
<td>body</td>
<td>object</td>
<td>false</td>
<td>none</td>
</tr>
<tr>
<td>workflow</td>
<td>body</td>
<td>string(binary)</td>
<td>false</td>
<td>CWL workflow file with embedded tools and all other dependencies</td>
</tr>
<tr>
<td>workflow_content</td>
<td>body</td>
<td>string</td>
<td>false</td>
<td>base64 encoded zlib compressed workflow content</td>
</tr>
</tbody>
</table><p>Response example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;dag_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dag_path&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cwl_path&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="get-list-of-dag-runs">
<h3><strong>3. Get list of dag_runs</strong><a class="headerlink" href="#get-list-of-dag-runs" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/dag_runs</span></code></p>
<p>Parameters:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Name</th>
<th>In</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dag_id</td>
<td>query</td>
<td>string</td>
<td>false</td>
<td>Dag identifier</td>
</tr>
<tr>
<td>run_id</td>
<td>query</td>
<td>string</td>
<td>false</td>
<td>Run identifier</td>
</tr>
<tr>
<td>execution_date</td>
<td>query</td>
<td>string(date-time)</td>
<td>false</td>
<td>Execution date</td>
</tr>
<tr>
<td>state</td>
<td>query</td>
<td>string</td>
<td>false</td>
<td>Dag run state</td>
</tr>
</tbody>
</table><p>Enumerated values:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>state</td>
<td>running</td>
</tr>
<tr>
<td>state</td>
<td>success</td>
</tr>
<tr>
<td>state</td>
<td>failed</td>
</tr>
</tbody>
</table><p>Response example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;dag_runs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;dag_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
      <span class="nt">&quot;run_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
      <span class="nt">&quot;execution_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-08-24T14:15:22Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;start_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-08-24T14:15:22Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;running&quot;</span><span class="p">,</span>
      <span class="nt">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
          <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;scheduled&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">&quot;progress&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="trigger-dag">
<h3><strong>4. Trigger dag</strong><a class="headerlink" href="#trigger-dag" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/dag_runs</span></code></p>
<p>Parameters:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Name</th>
<th>In</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dag_id</td>
<td>query</td>
<td>string</td>
<td>true</td>
<td>Dag identifier</td>
</tr>
<tr>
<td>run_id</td>
<td>query</td>
<td>string</td>
<td>false</td>
<td>Run identifier</td>
</tr>
<tr>
<td>conf</td>
<td>query</td>
<td>string</td>
<td>false</td>
<td>Run configuration (JSON-formatted string)</td>
</tr>
</tbody>
</table><p>Response example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;dag_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
  <span class="nt">&quot;run_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
  <span class="nt">&quot;execution_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-08-24T14:15:22Z&quot;</span><span class="p">,</span>
  <span class="nt">&quot;start_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-08-24T14:15:22Z&quot;</span><span class="p">,</span>
  <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;running&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="running-cwl-airflow-with-docker-compose">
<h2>Running CWL-Airflow with docker-compose<a class="headerlink" href="#running-cwl-airflow-with-docker-compose" title="Permalink to this headline"></a></h2>
<p>To start CWL-Airflow with LocalExecutor using docker-compose, run the following commands</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">./</span><span class="n">packaging</span><span class="o">/</span><span class="n">docker_compose</span><span class="o">/</span><span class="n">local_executor</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">up</span> <span class="o">--</span><span class="n">build</span>
</pre></div>
</div>
<p>Default values for mount volumes, mapped ports and other configurations can be found <code class="docutils literal notranslate"><span class="pre">.env</span></code> file in the
same folder.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Harvard University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>